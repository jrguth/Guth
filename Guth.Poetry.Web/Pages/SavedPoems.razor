@page "/saved"

<MudText Typo="Typo.h3">Saved Poems</MudText>
<MudGrid>
@foreach(PoemTitle poem in _savedPoems)
{
    <MudItem xs="6">
        <TitleCard
            Poem="@(new Poem { Title = poem.Title, Author = poem.Author.Name, Lines = poem.Lines.Split("\n") })"
            IsSaved="true">
        </TitleCard>
    </MudItem>
}
</MudGrid>


@code {
    [Inject] public IDbContextFactory<PoetryContext> ContextFactory { get; set; }

    private IEnumerable<PoemTitle> _savedPoems = Enumerable.Empty<PoemTitle>();

    protected override async Task OnInitializedAsync()
    {
        using (var context = ContextFactory.CreateDbContext())
        {
            _savedPoems = await context.Titles
                .Include(t => t.Author)
                .ToListAsync();
        }
    }
}
